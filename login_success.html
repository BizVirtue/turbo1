<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Login Success</title>
</head>
<body style="font-family: Arial; text-align:center; margin-top:80px;">
<h2>Login Successful</h2>
<p>Returning to appâ€¦</p>

<script>
function parseJwt (token) {
    var base64Url = token.split('.')[1];
    var base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
    var jsonPayload = decodeURIComponent(atob(base64).split('').map(function(c) {
        return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
    }).join(''));
    return JSON.parse(jsonPayload);
}

const urlParams = new URLSearchParams(window.location.search);
const jwt = urlParams.get("jwt");
const data = parseJwt(jwt);

const email = data.email;
const uid = data.sub;

window.location.href = "myapp://login?email=" + encodeURIComponent(email) + "&uid=" + encodeURIComponent(uid);
</script>

</body>
</html>
